<div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">
  <h1 style="margin-top: 0;">NanoWeb &ndash; NanoVNA Test System</h1>

  <p>
    NanoWeb is a complete, professional-level application for testing, calibrating, and monitoring a NanoVNA in real-time.
    The system integrates:
  </p>
  <ul>
    <li><strong>NanoVNA Management:</strong> Real communication with the device via <code>pynanovna</code> to perform sweeps, streaming of S-parameters, calibration, and exporting charts.</li>
    <li><strong>Advanced Web Interface:</strong> Built with Flask, providing:
      <ul>
        <li>Full control of the NanoVNA (band configuration, number of points, single or continuous sweep mode).</li>
        <li>Real-time display of S-parameters (magnitude and phase), Smith Chart (generated with <code>scikit-rf</code>), and TDR.</li>
        <li>Calibration functions and PNG/Touchstone exporting.</li>
        <li>Modern, responsive layout with a 3D sidebar, status bar, and action buttons.</li>
      </ul>
    </li>
    <li><strong>User and Antenna Management:</strong> Registration, login, antenna selection, and PDF/image uploads for datasheets.</li>
  </ul>

  <hr style="margin: 2em 0;" />

  <h2>Features</h2>
  <ul>
    <li><strong>Authentication &amp; Profile:</strong> Register and login securely with Flask-Login.</li>
    <li><strong>Antenna Management:</strong> Add, list, and select antennas, each with a PDF datasheet, image, and description.</li>
    <li><strong>NanoVNA Interface:</strong>
      <ul>
        <li>Sweep configuration (start/stop frequency in MHz, number of points).</li>
        <li>Single or continuous sweep modes, with adjustable polling intervals.</li>
        <li>Real-time S-parameters (S11 &amp; S21 in dB and phase), displayed in a canvas or via generated PNG images.</li>
        <li>Professional charts (Smith Chart, TDR) using <code>scikit-rf</code> and <code>matplotlib</code>.</li>
        <li>Device calibration and data export (PNG images, Touchstone files, etc.).</li>
        <li>Live status: device connection, last sweep timestamp, calibration state.</li>
      </ul>
    </li>
  </ul>

  <hr style="margin: 2em 0;" />

  <h2>Project Structure</h2>
  <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
FlaskServer/
├── config.py            # Configuration (SECRET_KEY, PostgreSQL URI, upload folder)
├── extensions.py        # Flask extensions (SQLAlchemy, LoginManager)
├── models.py            # Database models (User, Antena)
├── app.py               # Main Flask application and routes (including NanoVNA routes)
├── migrations/          # Database migration scripts (generated by Flask-Migrate)
├── templates/
│   ├── index.html       # Home page with user profile fields, antenna selection, and link to Nano
│   ├── login.html       # User login page
│   ├── register.html    # User registration page
│   ├── antena.html      # Antenna management (upload PDF/image, description)
│   └── nano.html        # NanoVNA control interface (sweep config, streaming, calibration)
└── static/
    ├── uploads/         # Folder for uploaded PDF/image files
    ├── index.css        # Common styles for index, login, register, antena
    ├── nano.css         # Styles for nano.html (3D sidebar, layout, etc.)
    └── nano.js          # JavaScript for nano.html (AJAX calls, real-time chart rendering)
  </pre>

  <hr style="margin: 2em 0;" />

  <h2>Installation &amp; Setup</h2>
  <ol>
    <li>
      <strong>Clone the repository:</strong>
      <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
git clone https://github.com/yourusername/NanoWeb.git
cd NanoWeb/FlaskServer
      </pre>
    </li>
    <li>
      <strong>Create and activate a virtual environment, then install dependencies:</strong>
      <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
      </pre>
      Make sure <code>requirements.txt</code> includes <code>Flask</code>, <code>Flask-Login</code>, <code>Flask-SQLAlchemy</code>, <code>Flask-Migrate</code>, <code>psycopg2-binary</code>, <code>pynanovna</code>, <code>scikit-rf</code>, <code>matplotlib</code>, <code>numpy</code>, etc.
    </li>
    <li>
      <strong>Set up PostgreSQL:</strong>  
      Install PostgreSQL and create a database:
      <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
sudo -u postgres psql -c "CREATE DATABASE nanoweb;"
      </pre>
      Ensure your <code>config.py</code> has the correct connection URI.
    </li>
    <li>
      <strong>Initialize and upgrade the database:</strong>
      <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
export FLASK_APP=app.py
flask db init       # only if migrations folder doesn't exist
flask db migrate -m "Initial migration"
flask db upgrade
      </pre>
    </li>
    <li>
      <strong>Run the application:</strong>
      <pre style="background: #f8f8f8; padding: 1em; overflow: auto; border-radius: 4px;">
flask run
      </pre>
      By default, the server runs at <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a>.
      Or run with <code>python app.py</code> if you've configured <code>if __name__ == "__main__"</code>.
    </li>
  </ol>

  <hr style="margin: 2em 0;" />

  <h2>Usage</h2>
  <ol>
    <li>
      <strong>Register and Log In:</strong>  
      Go to <code>/register</code> to create a user, then <code>/login</code> to authenticate.
    </li>
    <li>
      <strong>Select or Add Antennas:</strong>  
      In <code>/antena</code>, create new antennas (upload PDF/image, etc.) or select an existing one in the home page.
    </li>
    <li>
      <strong>Open NanoVNA Interface:</strong>  
      Click the button “Open NanoVNA” on the home page (<code>index.html</code>) to navigate to <code>/nano</code>.
    </li>
    <li>
      <strong>Configure and Sweep:</strong>  
      On <code>nano.html</code>, specify the start/stop frequencies and number of points. Choose <em>single</em> or <em>continuous</em> mode and start the sweep.
    </li>
    <li>
      <strong>View Data in Real Time:</strong>  
      For continuous mode, the page polls <code>/nano/data</code> periodically, rendering updated S-parameters in the canvas. You can also export images or Touchstone files if implemented in the back end.
    </li>
  </ol>

  <hr style="margin: 2em 0;" />

  <h2>APIs and Endpoints</h2>
  <ul>
    <li><code>POST /nano/sweep</code>: Receives <code>start_mhz</code>, <code>stop_mhz</code>, <code>points</code>, initiates a real sweep on the NanoVNA, and stores the data in memory.</li>
    <li><code>GET /nano/data</code>: Returns the most recent S-parameter data (freq in MHz, S11 dB/phase, S21 dB/phase) as JSON.</li>
    <li><code>POST /nano/calibrate</code>: Triggers device calibration using <code>pynanovna</code>.</li>
    <li><code>GET /nano/export_image</code>: Generates and returns a PNG image of S11 vs. frequency. You can create similar routes for Smith Chart, TDR, etc.</li>
    <li><code>GET /nano/status</code>: Returns the device status (connection, last sweep timestamp, etc.) in JSON.</li>
  </ul>

  <hr style="margin: 2em 0;" />

  <h2>License</h2>
  <p>
    This project is licensed under the <strong>MIT License</strong>. See the
    <code>LICENSE</code> file for details.
  </p>

  <h2>Contact</h2>
  <p>
    For questions or suggestions, please open an issue in this repository or contact
    <a href="mailto:gecesars@gmail.com">gecesars@gmail.com</a>.
  </p>
</div>
